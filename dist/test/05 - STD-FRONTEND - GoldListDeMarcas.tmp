/* 
 * Filename : 05 - STD-FRONTEND - GoldListDeMarcas
 * Author   : josemarsilva@inmetrics.com.br
 * Date     : 2019-02-14
 * Premissas: 
 *            * Layout obtido em 07/11/2018:
 *              - Formato: (.xlsx)
 *              - Colunas: "RAZÃO SOCIAL", "CNPJ", "CNPJ_2", "Tipo de Documento", "DATA DE RECEBIMENTO", "FILIAL", "Maquineta", "Diretoria", "Gerência", "Célula", "Gestor", "Numero Cadeia Forçada", "Nome Cadeia Forçada"

 *              - Regras:
 *                - EC's reservados para StressTest, transacionados pelo GeradorMassa ( dt_batch, nu_load_file)
 *                - EC não pode ser full SEC
 *                - EC's não pode ser número negativo porque não passa na validação
 *              - Exemplo de massa:
 *
 *            * Fluxo de Negócio: Montar lista com EC 
 *            * Importante que o esta planilha tem uma "carcaça" que tem títulos de colunas iniciando na linha 2 e não pode ser desrespeitado. Sera preciso exportar o resultado da query em outra planilha e depois copiar e colar a partir da celula A3
 *            * Query:
 *            * [TO-DO] Bug csv -> XLS está gerando apenas uma linha
 */
 
 SELECT ''                                 AS "RAZAO SOCIAL", 
        ''                                 AS "CNPJ", 
        ''                                 AS "CNPJ_2", 
        ''                                 AS "Tipo de Documento", 
        ''                                 AS "DATA DE RECEBIMENTO", 
        ''                                 AS "FILIAL", 
        TO_CHAR(m.nu_customer)             AS "Maquineta", 
        ''                                 AS "Diretoria", 
        ''                                 AS "Gerencia", 
        ''                                 AS "Celula", 
        ''                                 AS "Gestor", 
        ''                                 AS "Numero Cadeia Forcada", 
        ''                                 AS "Nome Cadeia Forcada"
 FROM   TBCTMR_MERCHANT m
 WHERE  1=1
        /* Condition */ 
 AND    EXISTS
        (
          SELECT 'X' FROM PERFSTAR.PERF_CLIENTE_TRANSACAO ct WHERE ct.nu_customer = m.nu_customer
        )
 AND    m.nu_customer+0 > 0
 AND    ROWNUM <= 200000
 AND    ROWNUM <= 10000 /* e-mail Nilton Amancio 22/02 */
 ORDER  BY m.nu_customer
 